{"ast":null,"code":"import _classCallCheck from\"C:\\\\npm\\\\repo2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\npm\\\\repo2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\npm\\\\repo2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\npm\\\\repo2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"C:\\\\npm\\\\repo2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\npm\\\\repo2\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React,{Component}from'react';import{postsFetched,getAllStatPostsImages}from\"./config/actions/index\";import{connect}from\"react-redux\";import{storage,fire,base,firestore}from'./config/Fire';import'quill/dist/quill.snow.css';import ReactQuill from'react-quill';export var Edit=/*#__PURE__*/function(_Component){_inherits(Edit,_Component);function Edit(props){var _this;_classCallCheck(this,Edit);_this=_possibleConstructorReturn(this,_getPrototypeOf(Edit).call(this,props));_this.handleImageAsFile=function(e){console.log(e.target.files[0]);var image=e.target.files[0];_this.setState({isFile:true});_this.setState({file:image});console.log(_this.state.file);};_this.deletePost=function(){var databaseRef=fire.database().ref('posts/'+_this.props.location.id).remove().then(function(){console.log(\"plik usuniety\");}).catch(function(error){console.log(\"bład:\"+error);});};_this.delete=function(id,name){// var desertRef = storage.child('images/1576580858304/images.png');\n// Delete the file\nvar deleteTask=storage.ref(\"/images/\".concat(id,\"/\").concat(name)).delete().then(function(){console.log(\"plik usuniety\");}).catch(function(error){console.log(\"bład:\"+error);});};_this.update=_this.update.bind(_assertThisInitialized(_this));_this.handleChangeEditor=_this.handleChangeEditor.bind(_assertThisInitialized(_this));// this.handleChange = this.handleChange.bind(this);\n_this.state={file:'',url:'',isFile:false,imagePreviewUrl:'',posts:{},currentUser:null,title:_this.props.location.title,text:_this.props.location.text,color:_this.props.location.color,id:_this.props.location.id};return _this;}_createClass(Edit,[{key:\"componentWillMount\",value:function componentWillMount(){this.postsRef=base.syncState('posts',{context:this,state:'posts'});}},{key:\"componentDidMount\",value:function componentDidMount(){}},{key:\"onprops\",value:function onprops(){if(this.props.location.id!=this.state.id){var title=this.props.location.title;var text=this.props.location.text;var id=this.props.location.id;var color=this.props.location.color;this.setState({title:title});this.setState({id:id});this.setState({text:text});this.setState({color:color});console.log(this.state.title);console.log(this.props.location.title);}}},{key:\"handleChangeTitle\",value:function handleChangeTitle(e){e.preventDefault();var title=e.target.value;this.setState({title:title});console.log(this.state.title);}},{key:\"handleChangeText\",value:function handleChangeText(e){e.preventDefault();var text=e.target.value;this.setState({text:text});console.log(e.target.value);}},{key:\"handleChangeColor\",value:function handleChangeColor(e){e.preventDefault();var color=e.target.value;this.setState({color:color});console.log(e.target.value);}},{key:\"update\",value:function update(e){e.preventDefault();var id=this.state.id;var title=this.state.title;var text=this.state.text;var color=this.state.color;console.log(this.state.id);//let userRef = this.firestore.ref('posts/' + this.props.location.id);\nvar databaseRef=fire.database().ref('posts/'+this.props.location.id);if(this.state.isFile){console.log(this.state.file);var uploadTask=storage.ref(\"/images/\".concat(this.state.id,\"/\").concat(this.state.file.name)).put(this.state.file);console.log(\"obrazek: \"+uploadTask);};// this is to get the stat-cards table from firebase\nvar statCardsRef=databaseRef.update({title:title,text:text,color:color}).then[function(){console.log('updated!');}];console.log(statCardsRef);// firestore.Collection('posts').oc(this.props.location.id).update({\n//   title: title,\n//   text: text,\n//   color: color\n// })\n//fire.database().ref().child('posts').child('1').set(data);\nconsole.log(this.props.posts);}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){console.log(this.props.posts);this.onprops();}},{key:\"_handleImageChange\",value:function _handleImageChange(e){var _this2=this;e.preventDefault();var reader=new FileReader();var file=e.target.files[0];reader.onloadend=function(){_this2.setState({file:file,imagePreviewUrl:reader.result});};reader.readAsDataURL(file);}},{key:\"handleChangeEditor\",value:function handleChangeEditor(editor){//console.log('background', editor);\nvar text=editor;this.setState({text:text});}},{key:\"render\",value:function render(){//const { quill, quillRef } = useQuill();\n//this.onprops();\n//wyśietlanie listy projektów\nvar imagePreviewUrl=this.state.imagePreviewUrl;var $imagePreview=null;if(imagePreviewUrl){$imagePreview=React.createElement(\"img\",{src:imagePreviewUrl});}else{$imagePreview=React.createElement(\"div\",{className:\"previewText\"},\"Please select an Image for Preview\");}console.log(this.props.location.title);console.log(this.props.images);return React.createElement(\"div\",null,React.createElement(\"h1\",null,\"Edytuj\"),React.createElement(\"form\",null,React.createElement(\"div\",{className:\"form-group\"},this.state.id,React.createElement(\"label\",{htmlFor:\"title\"},\"Tytu\\u0142\"),React.createElement(\"input\",{type:\"textarea\",value:this.state.title,onChange:this.handleChangeTitle.bind(this),name:\"title\",className:\"form-control\",placeholder:\"Enter title\"}),React.createElement(\"small\",{id:\"emailHelp\",className:\"form-text \"},\"We'll never share your email with anyone else.\")),React.createElement(\"div\",{className:\"form-group\"},React.createElement(\"label\",{htmlFor:\"exampleInputPassword1\"},\"tre\\u015B\\u0107\"),React.createElement(\"div\",{className:\"form-group\"},React.createElement(ReactQuill,{theme:\"snow\",value:this.state.text,onChange:this.handleChangeEditor,style:{width:500,height:500}}))),React.createElement(\"div\",{className:\"form-group\",style:{marginTop:'50px'}},React.createElement(\"input\",{name:\"color\",value:this.state.color,type:\"color\",id:\"myColor\",onChange:this.handleChangeColor.bind(this)})),React.createElement(\"div\",{className:\"form-group\"},React.createElement(\"input\",{className:\"fileInput\",type:\"file\",onChange:this.handleImageAsFile})),React.createElement(\"button\",{type:\"submit\",onClick:this.login,className:\"btn btn-primary\"},\"Usu\\u0144\"),React.createElement(\"div\",{className:\"imgPreview\"},$imagePreview),React.createElement(\"button\",{onClick:this.deletePost,style:{marginLeft:'25px'},className:\"btn btn-success\"},\"Usu\\u0144\"),React.createElement(\"button\",{onClick:this.update,style:{marginLeft:'25px'},className:\"btn btn-success\"},\"Zmie\\u0144\")),this.props.images.map(function(object,i){var _this3=this;return React.createElement(\"div\",null,object[0]==this.state.id&&React.createElement(\"p\",null,React.createElement(\"img\",{src:object[1],style:{width:'150px'}}),\"  \",React.createElement(\"button\",{onClick:function onClick(){return _this3.delete(object[0],object[2]);},className:\"btn btn-primary\"},\"Usu\\u0144\")));},this));}}]);return Edit;}(Component);var mapStateToProps=function mapStateToProps(state){return{posts:state.posts,images:state.allposts.statPostImages};};var mapDispatchToProps={postsFetched:postsFetched,getAllStatPostsImages:getAllStatPostsImages};export var EditContainer=connect(mapStateToProps,mapDispatchToProps)(Edit);","map":{"version":3,"sources":["C:/npm/repo2/src/Edit.js"],"names":["React","Component","postsFetched","getAllStatPostsImages","connect","storage","fire","base","firestore","ReactQuill","Edit","props","handleImageAsFile","e","console","log","target","files","image","setState","isFile","file","state","deletePost","databaseRef","database","ref","location","id","remove","then","catch","error","delete","name","deleteTask","update","bind","handleChangeEditor","url","imagePreviewUrl","posts","currentUser","title","text","color","postsRef","syncState","context","preventDefault","value","uploadTask","put","statCardsRef","onprops","reader","FileReader","onloadend","result","readAsDataURL","editor","$imagePreview","images","handleChangeTitle","width","height","marginTop","handleChangeColor","login","marginLeft","map","object","i","mapStateToProps","allposts","statPostImages","mapDispatchToProps","EditContainer"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { postsFetched,getAllStatPostsImages } from \"./config/actions/index\";\r\nimport { connect } from \"react-redux\";\r\nimport {storage, fire  , base, firestore}  from './config/Fire';\r\n\r\nimport 'quill/dist/quill.snow.css'; \r\nimport ReactQuill from 'react-quill';\r\nexport class Edit extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.update = this.update.bind(this);\r\n    this.handleChangeEditor = this.handleChangeEditor.bind(this);\r\n   \r\n   // this.handleChange = this.handleChange.bind(this);\r\n    this.state = {\r\n      file:'',\r\n      url:'',\r\n      isFile:false,\r\n      imagePreviewUrl: '',\r\n        posts: {},\r\n        currentUser: null,\r\n        title: this.props.location.title,\r\n        text: this.props.location.text,\r\n        color:  this.props.location.color,\r\n        id: this.props.location.id\r\n      };\r\n}\r\n\r\ncomponentWillMount(){\r\n  this.postsRef = base.syncState('posts',{\r\n      context: this,\r\n      state: 'posts'\r\n  });\r\n  \r\n  \r\n}\r\nhandleImageAsFile = (e) => {\r\n  console.log(e.target.files[0]);\r\n  const image = e.target.files[0]\r\n  this.setState({isFile: true})\r\n this.setState({file: image})\r\n console.log(this.state.file);\r\n}\r\ncomponentDidMount(){\r\n \r\n\r\n}\r\nonprops(){\r\n  if (this.props.location.id!=this.state.id){\r\n  const title=this.props.location.title;\r\n  const text=this.props.location.text;\r\n  const id=this.props.location.id;\r\n  const color=this.props.location.color;\r\n  this.setState({ title: title});\r\n  this.setState({ id: id});\r\n  this.setState({ text: text});\r\n  this.setState({ color: color});\r\n  console.log(this.state.title);\r\n  console.log(this.props.location.title);\r\n  }\r\n}\r\nhandleChangeTitle(e){\r\n  e.preventDefault();\r\n\r\n  const title = e.target.value;\r\n  this.setState({title});\r\n\r\n\r\n  console.log(this.state.title);\r\n\r\n}\r\nhandleChangeText(e){\r\n  e.preventDefault();\r\n  const text = e.target.value;\r\n \r\n  \r\n\r\n  this.setState({text});\r\n  console.log(e.target.value);\r\n \r\n\r\n}\r\nhandleChangeColor(e){\r\n  e.preventDefault();\r\n  const color = e.target.value;\r\n \r\n  \r\n\r\n  this.setState({color});\r\n  console.log(e.target.value);\r\n \r\n\r\n}\r\n\r\ndeletePost =() =>{\r\n  const databaseRef = fire.database().ref('posts/'+this.props.location.id).remove().then(() => {\r\n    console.log(\"plik usuniety\");\r\n  }).catch((error) => {\r\n   console.log(\"bład:\"+error);\r\n  });\r\n\r\n}\r\ndelete = (id,name)=>{\r\n\r\n // var desertRef = storage.child('images/1576580858304/images.png');\r\n  // Delete the file\r\n  const deleteTask = storage.ref(`/images/${id}/${name}`).delete().then(() => {\r\n    console.log(\"plik usuniety\");\r\n  }).catch((error) => {\r\n   console.log(\"bład:\"+error);\r\n  });\r\n  \r\n}\r\nupdate(e){\r\n  e.preventDefault();\r\n  const id = this.state.id;\r\n  const title = this.state.title;\r\n  const text = this.state.text;\r\n  const color = this.state.color;\r\n  console.log(this.state.id);\r\n  //let userRef = this.firestore.ref('posts/' + this.props.location.id);\r\n  const databaseRef = fire.database().ref('posts/'+this.props.location.id);\r\n  if  (this.state.isFile){\r\n\r\n    console.log(this.state.file);\r\n  const uploadTask = storage.ref(`/images/${this.state.id}/${this.state.file.name}`).put(this.state.file);\r\n  console.log(\"obrazek: \"+uploadTask);\r\n};\r\n// this is to get the stat-cards table from firebase\r\nconst statCardsRef = databaseRef.update({\r\n  \r\n  title: title,\r\n  text: text,\r\n  color: color\r\n}).then[()=> {\r\n  console.log('updated!');\r\n}];\r\n console.log(statCardsRef);\r\n \r\n  // firestore.Collection('posts').oc(this.props.location.id).update({\r\n  //   title: title,\r\n  //   text: text,\r\n  //   color: color\r\n  // })\r\n  \r\n \r\n  //fire.database().ref().child('posts').child('1').set(data);\r\n  console.log(this.props.posts);\r\n}\r\ncomponentDidUpdate(){\r\n  console.log(this.props.posts);\r\n  \r\n this.onprops();\r\n }\r\n _handleImageChange(e){\r\n  e.preventDefault();\r\n\r\n  let reader = new FileReader();\r\n  let file = e.target.files[0];\r\n\r\n  reader.onloadend = () => {\r\n    this.setState({\r\n      file: file,\r\n      imagePreviewUrl: reader.result\r\n    });\r\n  }\r\n\r\n  reader.readAsDataURL(file)\r\n\r\n };\r\n handleChangeEditor(editor) {\r\n  //console.log('background', editor);\r\n  const text = editor;\r\n   this.setState({text});\r\n};\r\n  render() {\r\n    //const { quill, quillRef } = useQuill();\r\n    //this.onprops();\r\n      //wyśietlanie listy projektów\r\n      let {imagePreviewUrl} = this.state;\r\n      let $imagePreview = null;\r\n      if (imagePreviewUrl) {\r\n        $imagePreview = (<img src={imagePreviewUrl} />);\r\n      } else {\r\n        $imagePreview = (<div className=\"previewText\">Please select an Image for Preview</div>);\r\n      }\r\n      console.log(this.props.location.title);\r\n     console.log(this.props.images);\r\n      return (<div>\r\n        <h1>Edytuj</h1>\r\n        <form>\r\n         \r\n        <div className=\"form-group\">\r\n        {this.state.id}\r\n         <label htmlFor=\"title\">Tytuł</label>\r\n         <input type=\"textarea\"  value={this.state.title} onChange={this.handleChangeTitle.bind(this)} name=\"title\" className=\"form-control\" placeholder=\"Enter title\" />\r\n         <small id=\"emailHelp\" className=\"form-text \">We'll never share your email with anyone else.</small>\r\n        </div>\r\n         <div className=\"form-group\">\r\n        <label htmlFor=\"exampleInputPassword1\">treść</label>\r\n        <div className=\"form-group\">\r\n   <ReactQuill theme=\"snow\" value={this.state.text} onChange={this.handleChangeEditor} style={{ width: 500, height: 500 }}/>\r\n   \r\n    </div>\r\n    </div>\r\n    <div className=\"form-group\" style={{ marginTop: '50px' }}>\r\n      <input name=\"color\" value={this.state.color} type=\"color\" id=\"myColor\" onChange={this.handleChangeColor.bind(this)} ></input>\r\n        </div>\r\n        <div className=\"form-group\">\r\n        <input className=\"fileInput\" \r\n            type=\"file\" \r\n            onChange={this.handleImageAsFile} />\r\n            </div>\r\n        <button type=\"submit\" onClick={this.login} className=\"btn btn-primary\">Usuń</button>\r\n        <div className=\"imgPreview\">\r\n          {$imagePreview}\r\n        </div>\r\n        \r\n\r\n      \r\n        <button onClick={this.deletePost} style={{marginLeft: '25px'}} className=\"btn btn-success\">Usuń</button>\r\n        <button onClick={this.update} style={{marginLeft: '25px'}} className=\"btn btn-success\">Zmień</button>\r\n   </form>\r\n   \r\n   {this.props.images.map(function(object,i){\r\n\r\nreturn (\r\n\r\n<div>\r\n       {\r\n            object[0] ==this.state.id && <p><img src={object[1]} style={{width: '150px'}}></img>  <button onClick={() => this.delete(object[0],object[2])} className=\"btn btn-primary\">Usuń</button></p>\r\n       }\r\n    </div>)\r\n},this)}\r\n   </div>\r\n      )\r\n   \r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  \r\n  return {\r\n    \r\n    posts: state.posts,\r\n    images: state.allposts.statPostImages\r\n  }\r\n};\r\nconst mapDispatchToProps = { postsFetched, getAllStatPostsImages };\r\n\r\nexport const EditContainer = connect(mapStateToProps, mapDispatchToProps)(Edit);"]},"metadata":{},"sourceType":"module"}